<!DOCTYPE html>
<html lang="en">
    <!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  
  <title>A novel deep framework for dynamic malware detection based on API sequence intrinsic features - Mr.K</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
  
<link rel="stylesheet" href="/css/post.css">

  

  
<meta name="generator" content="Hexo 5.3.0"></head>
    <body>
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/tags/essay">Essay</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item" target="_blank" rel="noopener" href="https://space.bilibili.com/344213153">Bilibili</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/Kinferiority" target="_blank">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        <article class="post">
    <div class="meta">
        
        <div class="date" id="date">
            
            
            
            
            
            
            
            
            
            
            
            <span>November</span>
            
            
            <span>5,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">A novel deep framework for dynamic malware detection based on API sequence intrinsic features</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p><a name="U4kBh"></a></p>
<h4 id="A-novel-deep-framework-for-dynamic-malware-detection-based-on-API-sequence-intrinsic-features-基于API-序列内在特征并且使用深度学习框架的动态恶意软件检测作者-Ce-Li-a-b-Qiujian-Lva-Ning-Lia-Yan-Wang-a-b-∗-Degang-Sun-a-b-Yuanyuan-Qiao-c"><a href="#A-novel-deep-framework-for-dynamic-malware-detection-based-on-API-sequence-intrinsic-features-基于API-序列内在特征并且使用深度学习框架的动态恶意软件检测作者-Ce-Li-a-b-Qiujian-Lva-Ning-Lia-Yan-Wang-a-b-∗-Degang-Sun-a-b-Yuanyuan-Qiao-c" class="headerlink" title="**A novel deep framework for dynamic malware detection based on API sequence intrinsic features**基于API 序列内在特征并且使用深度学习框架的动态恶意软件检测作者 Ce Li a,b, Qiujian Lva, Ning Lia, Yan Wang a,b,∗, Degang Sun a,b, Yuanyuan Qiao c"></a>**A novel deep framework for dynamic malware detection based on API sequence intrinsic features<br />**基于API 序列内在特征并且使用深度学习框架的动态恶意软件检测<br />作者 Ce Li a,b, Qiujian Lva, Ning Lia, Yan Wang a,b,∗, Degang Sun a,b, Yuanyuan Qiao c</h4><p><a name="HrPRE"></a></p>
<h4 id="a-Institute-of-Information-Engineering-Chinese-Academy-of-Science-Beijing-China"><a href="#a-Institute-of-Information-Engineering-Chinese-Academy-of-Science-Beijing-China" class="headerlink" title="a  Institute of Information Engineering, Chinese Academy of Science, Beijing, China"></a>a  Institute of Information Engineering, Chinese Academy of Science, Beijing, China</h4><p><a name="d5Sgl"></a></p>
<h4 id="b-School-of-Cyber-Security-University-of-Chinese-Academy-of-Science-Beijing-China"><a href="#b-School-of-Cyber-Security-University-of-Chinese-Academy-of-Science-Beijing-China" class="headerlink" title="b School of Cyber Security, University of Chinese Academy of Science, Beijing, China"></a>b School of Cyber Security, University of Chinese Academy of Science, Beijing, China</h4><p><a name="lasB8"></a></p>
<h4 id="c-School-of-Artiﬁcial-Intelligence-Beijing-University-of-Posts-and-Telecommunications-Beijing-China"><a href="#c-School-of-Artiﬁcial-Intelligence-Beijing-University-of-Posts-and-Telecommunications-Beijing-China" class="headerlink" title="c School of Artiﬁcial Intelligence, Beijing University of Posts and Telecommunications, Beijing, China"></a>c School of Artiﬁcial Intelligence, Beijing University of Posts and Telecommunications, Beijing, China</h4><p><a name="UgjPT"></a></p>
<h4 id="本文针对的恶意软件检测是Windows平台上的，采用的分析方法是API序列分析"><a href="#本文针对的恶意软件检测是Windows平台上的，采用的分析方法是API序列分析" class="headerlink" title="本文针对的恶意软件检测是Windows平台上的，采用的分析方法是API序列分析"></a><br />本文针对的恶意软件检测是Windows平台上的，采用的分析方法是API序列分析</h4><p><a name="O5XaD"></a></p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li>创新：提出了三种度量API序列语义信息的内在特征：<ul>
<li>the software behavior</li>
<li>the semantic information of APIs</li>
<li>the relationship between API calls.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/friendllcc/Malware-Detection-API-Sequence-Intrinsic-Features">开源</a>：提供数据库以及代码</li>
<li>思想：每个API的命名还有语义信息、API序列之间含有调用关系</li>
</ul>
<p><a name="UQZmu"></a></p>
<h4 id="先前研究的不足"><a href="#先前研究的不足" class="headerlink" title="先前研究的不足"></a>先前研究的不足</h4><ul>
<li><p>现有的关于API序列的分析，所抓取到的特征不够深入，仅仅停留在API的名字、API的使用频率上</p>
</li>
<li><p>已有的研究</p>
<ul>
<li>静态分析在遇到代码混淆时变得无用</li>
<li>在运行时，软件必须unpack，动态分析变得更有效率在遇到代码混淆时</li>
</ul>
</li>
</ul>
<ul>
<li><p>本文所提到一些ML与DL算法：</p>
<ul>
<li><p>ML中分析API序列的算法：</p>
<ul>
<li>K-Nearest Neighbor (KNN) </li>
<li>Naive Bayes (NB),</li>
<li>Decision Tree (DT),</li>
<li>Support Vector Machine (SVM)</li>
</ul>
</li>
<li><p>本文所使用到的DL算法：</p>
<ul>
<li>1D  CNN</li>
<li>Multi-layer Convolution</li>
<li>Bi-LSTM<ul>
<li>Çatak et al. (2020) use embedding layer and Long Short-Term Memory (LSTM) model to capture relationship between API calls in the API sequence.</li>
</ul>
</li>
<li>Embedding Layer<ul>
<li>（Amer and Zelinka (2020) use word embedding method to represent every API name as a vector which contains contextual information.）<br><a name="MOkjQ"></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="本文研究"><a href="#本文研究" class="headerlink" title="本文研究"></a>本文研究</h4><ul>
<li><strong>Frame</strong><ul>
<li><strong>Component</strong><ul>
<li><strong>An intrinsic feature encoder</strong></li>
<li><strong>A Multi-Layer Perceptron (MLP) classiﬁer</strong></li>
</ul>
</li>
<li><strong>Intrinsic feature encoding methods</strong><ul>
<li><strong>API Phrase</strong></li>
<li><strong>Semantic Chain</strong></li>
<li>** Bi-LSTM**</li>
</ul>
</li>
<li><strong>Purpose</strong><ul>
<li><strong>Characterize the multiple intrinsic features from the API sequence</strong></li>
<li>** Combine them to identify whether the running software is malicious or not**</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1697981635382-da7359fb-132a-47d7-8062-85162b89263b.png#averageHue=%23f4f3f1&clientId=u002786a4-19e8-4&from=paste&height=316&id=ua803f825&originHeight=631&originWidth=1561&originalType=binary&ratio=2&rotation=0&showTitle=false&size=376417&status=done&style=none&taskId=u263afe9d-f6e0-41ce-b30b-8e9e46079ce&title=&width=780.5" alt="image.png"><br><a name="AX501"></a></p>
<h4 id="编码器"><a href="#编码器" class="headerlink" title="编码器"></a>编码器</h4><p>API序列包含了软件行为、语义信息、API之间的联系信息</p>
<ul>
<li><strong>API Phrase</strong><ul>
<li>模型作用：描述了软件行为</li>
<li>编码过程<ul>
<li>将每一个API名字转化为一个向量，然后再将API 序列转化为一个序列矩阵</li>
<li>通过三个不同的卷积层，将序列矩阵转化为特征映射，使用不同的卷积核可以提取出不同长度下<strong>API Phrase</strong>的特征</li>
</ul>
</li>
<li><strong>API embedding</strong><ul>
<li><strong>使用嵌入层将每个API名字转化为一个K维度的特征向量</strong></li>
</ul>
</li>
<li><strong>API Sequence</strong><ul>
<li>**A 1: n = a 1  a 2  ···  an **</li>
</ul>
</li>
<li><strong>1D CNN  可以将序列矩阵转化为可以表示软件行为的API Phrase的特征映射</strong></li>
</ul>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1697982509557-e2ad6561-22f2-4dcc-bcac-6ec0d6900c5e.png#averageHue=%23f2f1f0&clientId=u5b663740-94d7-4&from=paste&height=263&id=u12772d60&originHeight=526&originWidth=1328&originalType=binary&ratio=2&rotation=0&showTitle=false&size=280916&status=done&style=none&taskId=u4edf7fbf-299e-46b3-83a0-9f38b7582ba&title=&width=664" alt="image.png"></p>
<ul>
<li><p><strong>Semantic chain</strong></p>
<p>API 命名语义上包含这多种信息 例如：<strong>action and operation object</strong>，将单个API可以拆解成以下形式<br /><strong>q i =&lt; action i , object i , class i , category i &gt; .</strong><br /><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1697982835143-b4676c95-5990-4e3e-8384-8891152712e0.png#averageHue=%23ededed&clientId=u5b663740-94d7-4&from=paste&height=182&id=u2a7d4727&originHeight=363&originWidth=740&originalType=binary&ratio=2&rotation=0&showTitle=false&size=61287&status=done&style=none&taskId=u1ea743b1-45c2-49ff-b16a-7e2d7deb77b&title=&width=370" alt="image.png"><br /><strong>与上文API Sequence的重定义一样，Semantic chain可以被定义为</strong><br />**Q 1: n = Q 1  Q 2  ···  Qn **</p>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1697983052216-5323026d-ade2-4370-9b37-82f7126a5c1a.png#averageHue=%23f4f1f1&clientId=u5b663740-94d7-4&from=paste&height=436&id=uf01f350f&originHeight=871&originWidth=1581&originalType=binary&ratio=2&rotation=0&showTitle=false&size=344348&status=done&style=none&taskId=ubadc5bbb-51df-4349-840f-1375c27d241&title=&width=790.5" alt="image.png"></p>
<ul>
<li>编码过程<ul>
<li>通过嵌入层将semantic chain转化为一个矩阵</li>
<li>通过一个的卷积层，获取semantic chain的特征映射</li>
</ul>
</li>
<li><strong>Bi-LSTM for relationship information representation</strong><ul>
<li><strong>将API Phrase和Semantic chain作为Bi- LSTM输入（X = m  m ′= { x 1, x 2, x t, . . . }）</strong></li>
<li><strong>隐藏层输出H = { h 1, h 2, h t, . . . }作为分类模型的输入</strong></li>
</ul>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1697983286524-9d529b7a-b7d7-43e5-ade8-d6af39537cb4.png#averageHue=%23f5f4f0&clientId=u5b663740-94d7-4&from=paste&height=377&id=u8fad2bf3&originHeight=754&originWidth=590&originalType=binary&ratio=2&rotation=0&showTitle=false&size=172921&status=done&style=none&taskId=uac946fa2-1ce1-4b5e-802f-19f0e2390cf&title=&width=295" alt="image.png"><br><a name="WdWKi"></a></p>
<h4 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1698237042639-6237a5fb-08d9-429e-b618-adf004d5cfdb.png#averageHue=%23eeeeee&clientId=u3d33aeed-a04d-4&from=paste&height=279&id=u05cf0166&originHeight=558&originWidth=1808&originalType=binary&ratio=2&rotation=0&showTitle=false&size=143176&status=done&style=none&taskId=u7734bc51-4956-44c4-a902-5380e19811e&title=&width=904" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1698237121923-f97e7b36-fa28-4d33-8647-c2ab159b7591.png#averageHue=%23f6f5f4&clientId=u3d33aeed-a04d-4&from=paste&height=620&id=u6a0f0613&originHeight=1240&originWidth=1262&originalType=binary&ratio=2&rotation=0&showTitle=false&size=599586&status=done&style=none&taskId=u79193d8b-0930-4c0f-a47f-a9a8dd45ebc&title=&width=631" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1698237052665-204d944e-0a1f-469d-a29d-48ad99728ae5.png#averageHue=%23f0f0f0&clientId=u3d33aeed-a04d-4&from=paste&height=510&id=ue3df28ad&originHeight=1020&originWidth=1760&originalType=binary&ratio=2&rotation=0&showTitle=false&size=293284&status=done&style=none&taskId=u19c544d1-7ea2-4f8d-bdb6-a3ab5409538&title=&width=880" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/38969425/1698237141082-4cb76a1f-fdbf-479a-9eb1-57b36bfcc610.png#averageHue=%23f7f7f6&clientId=u3d33aeed-a04d-4&from=paste&height=635&id=u92e628d8&originHeight=1270&originWidth=1344&originalType=binary&ratio=2&rotation=0&showTitle=false&size=432504&status=done&style=none&taskId=ud9fc83e3-b9b0-48bc-acc0-45568b2c92c&title=&width=672" alt="image.png"><br><a name="sSVDG"></a></p>
<h4 id="实验结果-1"><a href="#实验结果-1" class="headerlink" title="实验结果"></a>实验结果</h4><p>总结</p>
<ul>
<li>xxxxxx</li>
<li>xxxxxx</li>
<li>xxxxxx</li>
</ul>
<p><a name="cbjPo"></a></p>
<h4 id="启发"><a href="#启发" class="headerlink" title="启发"></a>启发</h4><ol>
<li>xxxxx</li>
<li>xxxxx</li>
<li>xxxxxxx</li>
<li>xxxxx</li>
</ol>

    </div>

    <div class="about">
        <h1>About this Post</h1>
        <p>This post is written by Kjr, licensed under <a
                target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
    </div>

    
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h4 class="title">Blog</h4>
                
                <a href="/" class="item" target="_blank">Blog</a>
                
                <a href="/archives" class="item" target="_blank">Archives</a>
                
                <a href="/tags/essay" class="item" target="_blank">Essay</a>
                
                <a href="/projects" class="item" target="_blank">Projects</a>
                
                <a href="/about" class="item" target="_blank">About</a>
                
                <a href="/atom.xml" class="item" target="_blank">RSS</a>
                
            </div>
            
            <div class="group">
                <h4 class="title">Me</h4>
                
                <a href="https://github.com/Kinferiority" class="item" target="_blank">GitHub</a>
                
                <a href="https://space.bilibili.com/344213153" class="item" target="_blank">Bilibili</a>
                
                <a href="mailto:kongkjr@qq.com" class="item" target="_blank">Email</a>
                
            </div>
            
        </div>
        &copy; 2023 Kjr<br />
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
</footer>

        
<script src="/js/main.js"></script>

        
    </body>
</html>
